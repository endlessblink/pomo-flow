<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restore Pomo-Flow Backup</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        button {
            background: #007acc;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #005a9e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ”§ Restore Pomo-Flow Backup</h1>
        <p>Restoring your 19 tasks from the backup file...</p>
        <button onclick="restoreBackup()">ðŸ”„ Restore Backup Now</button>
        <div id="result"></div>
    </div>

    <script>
        async function restoreBackup() {
            const resultDiv = document.getElementById('result')
            resultDiv.textContent = 'ðŸ”„ Restoring backup...'

            try {
                // Fetch the backup file
                const response = await fetch('/user-backup.json')
                if (!response.ok) {
                    throw new Error('Failed to fetch backup file')
                }

                const backupText = await response.text()
                const backup = JSON.parse(backupText)

                // Extract the data
                if (!backup.data || !Array.isArray(backup.data)) {
                    throw new Error('Invalid backup format')
                }

                // Store in localStorage for the recovery tool to pick up
                localStorage.setItem('pomo-flow-user-backup', JSON.stringify(backup.data))

                resultDiv.className = 'result success'
                resultDiv.textContent = `âœ… Successfully restored ${backup.data.length} tasks!\n\nTasks found:\n${backup.data.map(task => `â€¢ ${task.title} (${task.status})`).join('\n')}\n\nRefresh the Pomo-Flow app to see your restored tasks.`

            } catch (error) {
                resultDiv.className = 'result'
                resultDiv.textContent = `âŒ Error restoring backup: ${error.message}`
            }
        }

        // Auto-restore on page load
        window.addEventListener('load', () => {
            setTimeout(restoreBackup, 1000)
        })
    </script>
</body>
</html>