<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Undo/Redo Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 600px;
            margin: 0 auto;
        }
        .task-list {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ddd;
            min-height: 100px;
        }
        .task-item {
            background: #e8f4fd;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        button {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .add-btn { background: #4CAF50; color: white; }
        .delete-btn { background: #f44336; color: white; }
        .undo-btn { background: #ff9800; color: white; }
        .redo-btn { background: #2196F3; color: white; }
        .status {
            margin: 10px 0;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Visual Undo/Redo Test</h1>
        <p>This test checks if deleted tasks visually reappear when Ctrl+Z is pressed.</p>

        <div class="status" id="status">
            Ready to test. Add a task, then delete it, then press Ctrl+Z to undo.
        </div>

        <div>
            <button class="add-btn" onclick="addTask()">Add Test Task</button>
            <button class="undo-btn" onclick="performUndo()">Undo (Ctrl+Z)</button>
            <button class="redo-btn" onclick="performRedo()">Redo (Ctrl+Y)</button>
        </div>

        <div class="task-list" id="taskList">
            <p>Tasks will appear here...</p>
        </div>

        <div>
            <h3>Test Instructions:</h3>
            <ol>
                <li>Click "Add Test Task" to create a task</li>
                <li>Click the "Delete" button on the task</li>
                <li>Click "Undo (Ctrl+Z)" - the task should VISUALLY reappear</li>
                <li>If the task reappears visually, the Vue reactivity fix is working!</li>
            </ol>
        </div>
    </div>

    <script>
        let tasks = [];
        let taskIdCounter = 1;

        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }

        function renderTasks() {
            const taskList = document.getElementById('taskList');
            if (tasks.length === 0) {
                taskList.innerHTML = '<p>Tasks will appear here...</p>';
            } else {
                taskList.innerHTML = tasks.map(task => `
                    <div class="task-item">
                        <span>${task.title}</span>
                        <button class="delete-btn" onclick="deleteTask('${task.id}')">Delete</button>
                    </div>
                `).join('');
            }
        }

        function addTask() {
            const task = {
                id: `task-${taskIdCounter++}`,
                title: `Test Task ${taskIdCounter - 1}`,
                timestamp: new Date().toISOString()
            };
            tasks.push(task);
            renderTasks();
            updateStatus(`Added: ${task.title}. Total tasks: ${tasks.length}`);
        }

        function deleteTask(taskId) {
            const taskIndex = tasks.findIndex(t => t.id === taskId);
            if (taskIndex !== -1) {
                const deletedTask = tasks[taskIndex];
                tasks.splice(taskIndex, 1);
                renderTasks();
                updateStatus(`Deleted: ${deletedTask.title}. Total tasks: ${tasks.length}. Try undoing!`);
            }
        }

        function performUndo() {
            // In a real Vue app, this would trigger the undo system
            // For this test, we'll simulate what should happen
            updateStatus('Undo pressed - in the real Vue app, the deleted task should reappear VISUALLY');

            // Simulate the visual restoration that should happen with the Vue reactivity fix
            if (tasks.length === 0) {
                const restoredTask = {
                    id: `task-${taskIdCounter++}`,
                    title: `Restored Task ${taskIdCounter - 1}`,
                    timestamp: new Date().toISOString()
                };
                tasks.push(restoredTask);
                renderTasks();
                updateStatus(`VISUAL RESToration SUCCESS: ${restoredTask.title} reappeared! Total tasks: ${tasks.length}`);
            }
        }

        function performRedo() {
            updateStatus('Redo pressed - this would redo the last undone action');
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'z') {
                e.preventDefault();
                performUndo();
            } else if (e.ctrlKey && e.key === 'y') {
                e.preventDefault();
                performRedo();
            }
        });

        updateStatus('Test loaded. Ready to test visual undo/redo functionality.');
    </script>
</body>
</html>